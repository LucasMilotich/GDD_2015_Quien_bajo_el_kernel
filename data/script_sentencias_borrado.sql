
DECLARE @SqlStatement VARCHAR(MAX)
SELECT @SqlStatement = 
    COALESCE(@SqlStatement, '') + 'DROP TABLE [QUIEN_BAJO_EL_KERNEL].' + QUOTENAME(TABLE_NAME) + ';' + CHAR(13)
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = 'QUIEN_BAJO_EL_KERNEL'

PRINT @SqlStatement

select   'ALTER TABLE QUIEN_BAJO_EL_KERNEL.' + t.name + ' drop constraint ' + 
OBJECT_NAME(d.constraint_object_id)  + ';' + CHAR(13)
from sys.tables t 
    join sys.foreign_key_columns d on d.parent_object_id = t.object_id 
    inner join sys.schemas s on t.schema_id = s.schema_id
where s.name = 'QUIEN_BAJO_EL_KERNEL'
ORDER BY t.name;


--select 'DROP PROCEDURE QUIEN_BAJO_EL_KERNEL.'+t.name from sys.procedures t

IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CLIENTE_USUARIO]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CLIENTE]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CLIENTE DROP CONSTRAINT FK_CLIENTE_USUARIO;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_USUARIO_LOG_USUARIO]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[USUARIO_LOG]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.USUARIO_LOG DROP CONSTRAINT FK_USUARIO_LOG_USUARIO ;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_FUNCIONALIDADROL_FUNCIONALIDAD]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FUNCIONALIDAD_ROL]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.FUNCIONALIDAD_ROL drop constraint FK_FUNCIONALIDADROL_FUNCIONALIDAD;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_FACTURA_CLIENTE]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FACTURA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.FACTURA DROP CONSTRAINT FK_FACTURA_CLIENTE;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CUENTA_MODIFICACION_CUENTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA_MODIFICACION]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CUENTA_MODIFICACION DROP CONSTRAINT FK_CUENTA_MODIFICACION_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CUENTA_MODIFICACION_TRANSACCIONES]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA_MODIFICACION]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CUENTA_MODIFICACION DROP CONSTRAINT FK_CUENTA_MODIFICACION_TRANSACCIONES;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_FUNCIONALIDAD_ROL_ROL]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FUNCIONALIDAD_ROL]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.FUNCIONALIDAD_ROL DROP CONSTRAINT FK_FUNCIONALIDAD_ROL_ROL;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_USUARIO_ROL_ROL]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[USUARIO_ROL]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.USUARIO_ROL DROP CONSTRAINT FK_USUARIO_ROL_ROL;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_USUARIO_ROL_USUARIO]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[USUARIO_ROL]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.USUARIO_ROL DROP CONSTRAINT FK_USUARIO_ROL_USUARIO;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CHEQUE_BANCO]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[UsuarioRol]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CHEQUE DROP CONSTRAINT FK_CHEQUE_BANCO;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CHEQUE_TIPO_MONEDA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CHEQUE]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CHEQUE DROP CONSTRAINT FK_CHEQUE_TIPO_MONEDA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_RETIRO_CHEQUE]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[RETIRO]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.RETIRO DROP CONSTRAINT FK_RETIRO_CHEQUE;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_RETIRO_CUENTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[RETIRO]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.RETIRO DROP CONSTRAINT FK_RETIRO_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_TRANSFERENCIA_CUENTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TRANSFERENCIA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA DROP CONSTRAINT FK_TRANSFERENCIA_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_TRANSFERENCIA_CUENTA_DESTINO]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TRANSFERENCIA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA DROP CONSTRAINT FK_TRANSFERENCIA_CUENTA_DESTINO;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_TRANSFERENCIA_TIPO_MONEDA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TRANSFERENCIA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA DROP CONSTRAINT FK_TRANSFERENCIA_TIPO_MONEDA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_TRANSFERENCIA_TRANSACCIONES]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TRANSFERENCIA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA DROP CONSTRAINT FK_TRANSFERENCIA_TRANSACCIONES;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_DEPOSITO_CUENTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[DEPOSITO]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.DEPOSITO DROP CONSTRAINT FK_DEPOSITO_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_DEPOSITO_TARJETA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[DEPOSITO]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.DEPOSITO DROP CONSTRAINT FK_DEPOSITO_TARJETA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_DEPOSITO_TIPO_MONEDA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[DEPOSITO]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.DEPOSITO DROP CONSTRAINT FK_DEPOSITO_TIPO_MONEDA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CLIENTE_PAIS]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CLIENTE]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CLIENTE DROP CONSTRAINT FK_CLIENTE_PAIS;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CLIENTE_TIPO_DOCUMENTO]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CLIENTE]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CLIENTE DROP CONSTRAINT FK_CLIENTE_TIPO_DOCUMENTO;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CUENTA_CLIENTE]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CUENTA DROP CONSTRAINT FK_CUENTA_CLIENTE;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CUENTA_PAIS]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CUENTA DROP CONSTRAINT FK_CUENTA_PAIS;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CUENTA_TIPO_CUENTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CUENTA DROP CONSTRAINT FK_CUENTA_TIPO_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CUENTA_TIPO_ESTADO_CUENTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CUENTA DROP CONSTRAINT FK_CUENTA_TIPO_ESTADO_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_CUENTA_TRANSACCIONES]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA]'))
ALTER TABLE QUIEN_BAJO_EL_KERNEL.CUENTA DROP CONSTRAINT FK_CUENTA_TRANSACCIONES;
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_I_FACT_ACTCTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_ACTIVACION_CUENTA]'))
ALTER TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_ACTIVACION_CUENTA] DROP CONSTRAINT [FK_I_FACT_ACTCTA]
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_IF_ACTCTA_ACTCTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_ACTIVACION_CUENTA]'))
ALTER TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_ACTIVACION_CUENTA] DROP CONSTRAINT [FK_IF_ACTCTA_ACTCTA]
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_I_FACT_MODCTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_MODIFICACION_CUENTA]'))
ALTER TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_MODIFICACION_CUENTA] DROP CONSTRAINT [FK_I_FACT_MODCTA]
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_IF_MODCTA_MODCTA]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_MODIFICACION_CUENTA]'))
ALTER TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_MODIFICACION_CUENTA] DROP CONSTRAINT [FK_IF_MODCTA_MODCTA]
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_I_FACT_TRANSF]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_TRANSFERENCIAS]'))
ALTER TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_TRANSFERENCIAS] DROP CONSTRAINT [FK_I_FACT_TRANSF]
GO
IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FK_IF_TRANSF_TRANSF]') AND parent_object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_TRANSFERENCIAS]'))
ALTER TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_TRANSFERENCIAS] DROP CONSTRAINT [FK_IF_TRANSF_TRANSF]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FACTURA]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.FACTURA;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA_MODIFICACION]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.CUENTA_MODIFICACION;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FUNCIONALIDAD_ROL]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.FUNCIONALIDAD_ROL;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[USUARIO_ROL]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.USUARIO_ROL;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ROL]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.ROL;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[USUARIO]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.USUARIO;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TIPO_CUENTA]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.TIPO_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TIPO_ESTADO_CUENTA]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.TIPO_ESTADO_CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TIPO_MONEDA]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.TIPO_MONEDA;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TIPO_DOCUMENTO]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.TIPO_DOCUMENTO;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[PAIS]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.PAIS;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[BANCO]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.BANCO;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CHEQUE]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.CHEQUE;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[RETIRO]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.RETIRO;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TRANSFERENCIA]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[TARJETA]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.TARJETA;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[DEPOSITO]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.DEPOSITO;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CLIENTE]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.CLIENTE;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[CUENTA]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.CUENTA;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[FUNCIONALIDAD]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.FUNCIONALIDAD;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[USUARIO_LOG]') AND type in (N'U'))
DROP TABLE QUIEN_BAJO_EL_KERNEL.USUARIO_LOG;
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[EMISOR_TARJETA]') AND type in (N'U'))
DROP TABLE [QUIEN_BAJO_EL_KERNEL].[EMISOR_TARJETA]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_MODIFICACION_CUENTA]') AND type in (N'U'))
DROP TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_MODIFICACION_CUENTA]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_ACTIVACION_CUENTA]') AND type in (N'U'))
DROP TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_ACTIVACION_CUENTA]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_TRANSFERENCIAS]') AND type in (N'U'))
DROP TABLE [QUIEN_BAJO_EL_KERNEL].[ITEM_FACTURA_TRANSFERENCIAS]
GO


/************ DROP SPs **************************/
DECLARE @CantidadSPs int
SELECT @CantidadSPs = COUNT(*) FROM sys.objects WHERE type in (N'P', N'PC') AND SCHEMA_NAME(schema_id) = N'QUIEN_BAJO_EL_KERNEL'
WHILE @CantidadSPs > 0
BEGIN
	DECLARE @SPName nvarchar(max)
	SELECT TOP 1 @SPName = name FROM sys.objects WHERE type in (N'P', N'PC') AND SCHEMA_NAME(schema_id) = N'QUIEN_BAJO_EL_KERNEL'
	DECLARE @Sql nvarchar(max)
	SET @Sql = 'DROP PROCEDURE [QUIEN_BAJO_EL_KERNEL].' + @SPName
	exec sp_executesql @Sql
	SET @CantidadSPs = @CantidadSPs - 1
END
GO

IF OBJECT_ID('[QUIEN_BAJO_EL_KERNEL].[TransaccionesClientes]', 'V') IS NOT NULL
    DROP VIEW [QUIEN_BAJO_EL_KERNEL].[TransaccionesClientes];
GO
IF OBJECT_ID('[QUIEN_BAJO_EL_KERNEL].[MovimientosPaises]', 'V') IS NOT NULL
    DROP VIEW [QUIEN_BAJO_EL_KERNEL].[MovimientosPaises];
GO

IF  EXISTS (SELECT * FROM sys.schemas WHERE name = N'QUIEN_BAJO_EL_KERNEL')
DROP SCHEMA [QUIEN_BAJO_EL_KERNEL]
GO