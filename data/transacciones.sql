CREATE PROCEDURE QUIEN_BAJO_EL_KERNEL.completar_transacciones
AS
BEGIN

DECLARE @CANT_CUENTAS NUMERIC(18,0)
DECLARE @CANT_CUENTAS_MODIF NUMERIC(18,0)
DECLARE @CANT_TRANSF NUMERIC(18,0)
DECLARE @i NUMERIC(18,0)
DECLARE @cuenta NUMERIC(18,0)
DECLARE @transf NUMERIC(18,0)


SELECT @CANT_CUENTAS =  COUNT(*) FROM QUIEN_BAJO_EL_KERNEL.CUENTA
SELECT @CANT_CUENTAS_MODIF = COUNT(*) FROM QUIEN_BAJO_EL_KERNEL.CUENTA_MODIFICACION
SELECT @CANT_TRANSF = COUNT(*) FROM QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA

-- LIMPIO

update QUIEN_BAJO_EL_KERNEL.CUENTA SET id_transaccion = NULL 
update QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA SET id_transaccion = NULL 
delete from QUIEN_BAJO_EL_KERNEL.TRANSACCIONES
DBCC CHECKIDENT ('QUIEN_BAJO_EL_KERNEL.TRANSACCIONES', RESEED,0)


SET @i = 1

WHILE @i <= @CANT_CUENTAS
BEGIN
	
	INSERT INTO QUIEN_BAJO_EL_KERNEL.TRANSACCIONES (operacion_tipo) 
		   VALUES (2)
	SET @i = @i + 1 

END

SET @i = 0
UPDATE QUIEN_BAJO_EL_KERNEL.CUENTA 
SET @i= id_transaccion = @i + 1
WHERE id_transaccion is null


SET @i = 1

WHILE @i <= @CANT_TRANSF
BEGIN
	
	INSERT INTO QUIEN_BAJO_EL_KERNEL.TRANSACCIONES (operacion_tipo) 
		   VALUES (1)
	
	SET @i = @i + 1 

END
SET @i = @CANT_CUENTAS
UPDATE QUIEN_BAJO_EL_KERNEL.TRANSFERENCIA 
SET @i = id_transaccion = @i + 1
WHERE id_transaccion is null


END

